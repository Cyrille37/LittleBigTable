function LittleBigTable(t){return{settings:{url:null,key_prefix:"lbt",limit:10,multisort:!1,messages:{loading:"Loading...",failed:"Loading failed",summary:"rows"},formatters:{},icon:"../dist/icons.svg"},meta:{loading:!1,status:null},params:{limit:10,offset:0,search:null,total:0},rows:[],sort:{},init:function(){for(i in this.params.limit=localStorage.getItem(this.settings.key_prefix+".limit"),(this.params.limit<10||this.params.limit>100)&&(this.params.limit=this.settings.limit),t)this.settings.hasOwnProperty(i)&&(this.settings[i]=t[i]);this.fetch()},fetch:function(){this.settings.url?(this.meta.loading=!0,this.setStatus(this.settings.messages.loading),fetch(this.settings.url+this.getUrlParams(),{headers:{Origin:"http://localhost:8080","Content-type":"application/x-www-form-urlencoded"}}).then(t=>t.json()).then(t=>{for(i in this.rows=[],this.params.total=t.total,t.data)this.addRow(t.data[i])}).then(()=>{this.meta.loading=!1,this.setStatus(this.getSummary(this.settings.messages.summary))}).catch(t=>{console.error("Network fetch failed:",t),this.setStatus(this.settings.messages.failed)})):this.setStatus("Missing api url, pass it in the settings.")},addRow:function(t){let s={};for(i in t)"function"==typeof this.settings.formatters[i]?(fn=this.settings.formatters[i],s[i]=fn(t[i],t)):s[i]=t[i];this.rows.push(s)},getUrlParams:function(){let t="?limit="+this.params.limit+"&offset="+this.params.offset;this.params.search&&(t+="&search="+this.params.search);let s=null;for(i in this.sort)s=i+":"+this.sort[i];return s&&(t+="&sort="+s),t},getCurrentPage:function(){return 0==this.params.offset?1:parseInt(parseInt(this.params.offset)/parseInt(this.params.limit)+1)},getTotalPages:function(){return parseInt(Math.ceil(parseInt(this.params.total)/parseInt(this.params.limit)))},getTotalRows:function(){return parseInt(this.params.total)},getFirstPageOffset:function(){return 0},getPrevPageOffset:function(){let t=parseInt(parseInt(this.getCurrentPage()-2)*parseInt(this.params.limit));return t<0?0:t},getNextPageOffset:function(){return parseInt(parseInt(this.getCurrentPage())*parseInt(this.params.limit))},getLastPageOffset:function(){let t=parseInt(parseInt(this.getTotalPages()-1)*parseInt(this.params.limit));return t<0?0:t},getOffsetForPage:function(){for(i=0;i<parseInt(this.params.total);i+=parseInt(this.params.limit))if(i>=this.getPrevPageOffset()&&i<=this.getNextPageOffset())return parseInt(i)+parseInt(this.params.limit);return this.getLastPageOffset()},getFirstDisplayedRow:function(){return this.params.offset+1},getLastDisplayedRow:function(){let t=parseInt(this.params.offset)+parseInt(this.params.limit);return t>this.params.total&&(t=this.params.total),t},getSummary:function(t="rows",s="results"){return this.rows.length?"pages"==t.toLowerCase()?"Showing page <strong>"+this.getCurrentPage()+"</strong> of <strong>"+this.getTotalPages()+"</strong>":"Showing <strong>"+this.getFirstDisplayedRow()+"</strong> to <strong>"+this.getLastDisplayedRow()+"</strong> of <strong>"+this.getTotalRows()+"</strong> "+s:"No results"},getSortIcon:function(t){let s="none";return void 0!==this.sort[t]&&(s=this.sort[t]),'<svg class="icon"><use xlink:href="'+this.settings.icon+"#sort-"+s+'"></use></svg>'},setLimit:function(){(this.params.limit<10||this.params.limit>100)&&(this.params.limit=25),this.params.offset=this.getOffsetForPage(),localStorage.setItem(this.settings.key_prefix+".limit",this.params.limit),this.fetch()},setStatus:function(t){this.meta.status=t},toggleSortColumn:function(t){void 0==this.sort[t]?this.sort[t]="asc":"asc"==this.sort[t]?this.sort[t]="dsc":"dsc"==this.sort[t]&&delete this.sort[t]},goFirstPage:function(){this.params.offset=this.getFirstPageOffset(),this.fetch()},goLastPage:function(){this.params.offset=this.getLastPageOffset(),this.fetch()},goNextPage:function(){this.params.offset=this.getNextPageOffset(),this.fetch()},goPrevPage:function(){this.params.offset=this.getPrevPageOffset(),this.fetch()},goToPage:function(){},doSearch:function(){this.params.offset=0,this.fetch()},doSort:function(t){if(0==this.settings.multisort){let s=this.sort[t];this.sort={},this.sort[t]=s}this.toggleSortColumn(t),this.fetch()},debug:function(){return JSON.stringify(this.params)+JSON.stringify(this.meta)+JSON.stringify(this.sort)}}}